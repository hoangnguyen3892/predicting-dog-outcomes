model2 = vglm(OutcomeType ~ HasName+TimeofDay+WeekDay+Sex+IsIntact+Age+MixorMultipleorSimple
+Group+Size+IsMixColor, family = multinomial(refLevel = 1), data = train)
summary(model2)
library(nnet)   # multinomial regression
library(VGAM)   # multinomial regression
train <- read.csv('train_processed_R.csv', header = T, stringsAsFactors = F, na.strings = "", strip.white=TRUE)
# Variables
OutcomeType <- as.factor(train$OutcomeType)
HasName <- as.factor(train$HasName)
TimeofDay <- as.factor(train$TimeofDay)
WeekDay <- as.factor(train$WeekDay)
Sex <- as.factor(train$Sex)
IsIntact <- as.factor(train$IsIntact)
Age <- train$Age
IsMixBreed <- as.factor(train$IsMixBreed)
MixorMultipleorSimple <- as.factor(train$MixorMultipleorSimple)
Group <- as.factor(train$Group)
Size <- train$Size
IsMixColor <- as.factor(train$IsMixColor)
# Use MixorMultipleorSimple/ not use IsMixBreed
model1 = multinom(OutcomeType ~ HasName+TimeofDay+WeekDay+Sex+IsIntact+Age+MixorMultipleorSimple
+IsMixBreed+Group+Size+IsMixColor)
summary(model1)
model2 = vglm(OutcomeType ~ HasName+TimeofDay+WeekDay+Sex+IsIntact+Age+MixorMultipleorSimple
+Group+Size+IsMixColor, family = multinomial(refLevel = "Adoption"), data = train)
summary(model2)
model = vglm(OutcomeType ~ 1, family = multinomial(refLevel = 1), data = train)
lrtest(model1, model)
LLf <- VGAM::logLik(model1)
LL0 <- VGAM::logLik(model)
as.vector(1 - (LLf/LL0))
lrtest(model2, model)
LLf1 <- VGAM::logLik(model2)
as.vector(1 - (LLf1/LL0))
confint(model2)
library(nnet)   # multinomial regression
library(VGAM)   # multinomial regression
train <- read.csv('train_processed_R.csv', header = T, stringsAsFactors = F, na.strings = "", strip.white=TRUE)
# Variables
OutcomeType <- as.factor(train$OutcomeType)
HasName <- as.factor(train$HasName)
TimeofDay <- as.factor(train$TimeofDay)
WeekDay <- as.factor(train$WeekDay)
Sex <- as.factor(train$Sex)
IsIntact <- as.factor(train$IsIntact)
Age <- train$Age
IsMixBreed <- as.factor(train$IsMixBreed)
MixorMultipleorSimple <- as.factor(train$MixorMultipleorSimple)
Group <- as.factor(train$Group)
Size <- train$Size
IsMixColor <- as.factor(train$IsMixColor)
summary(train)
# Use MixorMultipleorSimple/ not use IsMixBreed
model1 = multinom(OutcomeType ~ HasName+TimeofDay+WeekDay+Sex+IsIntact+Age+MixorMultipleorSimple
+IsMixBreed+Group+Size+IsMixColor)
summary(model1)
model2 = vglm(OutcomeType ~ HasName+TimeofDay+WeekDay+Sex+IsIntact+Age+MixorMultipleorSimple
+Group+Size+IsMixColor, family = multinomial(refLevel = "Adoption"), data = train)
summary(model2)
plot(model2)
qqPlot(model2, main="QQ Plot")
library("car", lib.loc="/Library/Frameworks/R.framework/Versions/3.3/Resources/library")
qqPlot(model2, main="QQ Plot")
vif(model2)
library(gvlma)
gvmodel <- gvlma(model2)
model2 = vglm(OutcomeType ~ HasName+TimeofDay+WeekDay+Sex+IsIntact+Age+MixorMultipleorSimple
+Group+Size+IsMixColor, family = multinomial(refLevel = "Adoption"), data = train)
summary(model2)
plot(model2)
vif(model2)
library(gvlma)
gvmodel <- gvlma(model2)
summary(gvmodel)
library(nnet)   # multinomial regression
library(VGAM)   # multinomial regression
train <- read.csv('train_processed_R.csv', header = T, stringsAsFactors = F, na.strings = "", strip.white=TRUE)
# Variables
OutcomeType <- as.factor(train$OutcomeType)
HasName <- as.factor(train$HasName)
TimeofDay <- as.factor(train$TimeofDay)
WeekDay <- as.factor(train$WeekDay)
Sex <- as.factor(train$Sex)
IsIntact <- as.factor(train$IsIntact)
Age <- train$Age
IsMixBreed <- as.factor(train$IsMixBreed)
MixorMultipleorSimple <- as.factor(train$MixorMultipleorSimple)
Group <- as.factor(train$Group)
Size <- train$Size
IsMixColor <- as.factor(train$IsMixColor)
# Use MixorMultipleorSimple/ not use IsMixBreed
model1 = multinom(OutcomeType ~ HasName+TimeofDay+WeekDay+Sex+IsIntact+Age+MixorMultipleorSimple
+IsMixBreed+Group+Size+IsMixColor)
summary(model1)
model2 = vglm(OutcomeType ~ HasName+TimeofDay+WeekDay+Sex+IsIntact+Age+MixorMultipleorSimple
+Group+Size+IsMixColor, family = multinomial(refLevel = "Adoption"), data = train)
summary(model2)
# Just for interest, calculating t-stats
t <- summary(model2)$coefficients/summary(model2)$standard.errors
confint(model2)
model1 = multinom(OutcomeType ~ HasName+TimeofDay+WeekDay+Sex+IsIntact+Age+MixorMultipleorSimple
+IsMixBreed+Group+Size+IsMixColor)
t <- summary(model1)$coefficients/summary(model1)$standard.errors
t
setwd("~/Google Drive/UNIST/2016_2nd_Courses/multivariate statistics/multivariate_project/austin/r")
library(ggplot2)  # visualize
library(ggthemes)
library(dplyr) # data manipulation
library(nnet)   # multinomial regression
library(VGAM)   # multinomial regression
library(randomForest) # classification algorithm
train <- read.csv('train_processed_R.csv', header = T, stringsAsFactors = F, na.strings = "", strip.white=TRUE)
View(train)
setwd("~/Google Drive/UNIST/2016_2nd_Courses/multivariate statistics/multivariate_project/austin/r")
library(ggplot2)  # visualize
library(ggthemes)
library(dplyr) # data manipulation
library(nnet)   # multinomial regression
library(VGAM)   # multinomial regression
library(randomForest) # classification algorithm
train <- read.csv('train_processed_R.csv', header = T, stringsAsFactors = F, na.strings = "", strip.white=TRUE)
setwd("~/Google Drive/UNIST/2016_2nd_Courses/multivariate statistics/multivariate_project/austin/r")
library(lubridate)  # dates
library(ggplot2)  # visualize
library(ggthemes)
library(dplyr) # data manipulation
library(nnet)   # multinomial regression
library(VGAM)   # multinomial regression
library(randomForest) # classification algorithm
library(xgboost)    # tree learning algorithm
library(formattable)
library(pander)
#library(VIM)
#library(mice)   # missing value
# Read data
train <- read.csv('train.csv', header = T, stringsAsFactors = F, na.strings = "", strip.white=TRUE)
dog_breeds <- read.csv("dog_breeds.csv", header = T, stringsAsFactors = FALSE, strip.white=TRUE)
#unique(train$SexuponOutcome)
###########################################################################
#                          Data preprocessing                             #
###########################################################################
################################################################################################################
# Data of dogs
train = subset(train, train$AnimalType !="Cat")
# TRACKING
nrow(train)   # 15595
#------------------------------------------------------------------------------------------------------
# Objective: Non-metric variable: HasName (0: has name, 1: no name)
#----------------------Name----------------------
# Replace blank names with "Nameless"
#train$Name <- ifelse(is.na(train$Name)==TRUE), 'Nameless', train$Name)
train$Name[is.na(train$Name)] <- "Nameless"
# Make a name/no name variable
#train$HasName[train$Name == 'Nameless'] <- 0
#train$HasName[train$Name != 'Nameless'] <- 1
train$HasName = ifelse(train$Name == 'Nameless', 0, 1)
#------------------------------------------------------------------------------------------------------
# Objective:  Non metric variable: TimeofDay (morning, midday, lateday and night)
#             Non metric variable: WeekDay (Monday, Tuesday, ..., Sunday)
#----------------------DateTime----------------------
# Extract time variables from date (uses the "lubridate" package)
train$Hour    <- hour(train$DateTime)
train$Weekday <- wday(train$DateTime)
train$Month   <- month(train$DateTime)
train$Year    <- year(train$DateTime)
train$TimeofDay <-  ifelse(train$Hour >= 5 & train$Hour < 11, 'morning',
ifelse(train$Hour >= 11 & train$Hour < 16, 'midday',
ifelse(train$Hour >= 15 & train$Hour < 20, 'lateday', 'night')))
train$TimeofDay <- factor(train$TimeofDay, levels = c('morning', 'midday','lateday', 'night'))
# Get the date value
train$Date = sapply(train$DateTime, function(x) strsplit(x, split = ' ')[[1]][1])
train$WeekDay = weekdays(as.Date(train$Date))
train$WeekDay <- factor(train$WeekDay, levels = c("Monday", "Tuesday","Wednesday", "Thursday",
"Friday", "Saturday", "Sunday"))
#------------------------------------------------------------------------------------------------------
# Objective: Non metric dependent variable Outcome (Return_to_owner, Adoption, Transfer, Euthanasia, Died)
#----------------------OutcomeType----------------------
unique(train$OutcomeType, incomparables = FALSE)
subset(train, train$OutcomeType !="Relocate")
subset(train, train$OutcomeType !="Disposal")
subset(train, train$OutcomeType !="Missing")
train$OutcomeType <- factor(train$OutcomeType, levels = c('Adoption', 'Transfer','Return_to_owner',
nrow(train)
View(train)
View(train)
#------------------------------------------------------------------------------------------------------
# Objective: Delete this unused variable
#----------------------OutcomeSubType----------------------
#unique(train$OutcomeSubtype, incomparables = FALSE)
# This information is not really helpful --> Delete
train$OutcomeSubtype <- NULL
#------------------------------------------------------------------------------------------------------
# Objective:  Non metric variable: IsIntact (0: no, 1: yes)
#             Non metric variable: Sex (Male, Female)
#----------------------SexuponOutcome----------------------
unique(train$SexuponOutcome, incomparables = FALSE)
#train$sex = sapply(train$SexuponOutcome, function(x) strsplit(x, split = ' ')[[1]][1])
train$IsIntact =    ifelse(train$SexuponOutcome == "Neutered Male" | train$SexuponOutcome == "Spayed Female", 0,
ifelse(train$SexuponOutcome == "Intact Male" | train$SexuponOutcome == "Intact Female", 1, NA))
train$Sex =   ifelse(train$SexuponOutcome == "Neutered Male" | train$SexuponOutcome == "Intact Male", 'Male',
ifelse(train$SexuponOutcome == "Spayed Female" | train$SexuponOutcome == "Intact Female", "Female",
NA))
# TRACKING
#nrow(train)   # 15595
#summary(train$Sex == "Male")
#summary(train$IsIntact == 0)
#------------------------------------------------------------------------------------------------------
# Objective:  Metric variable: AgeinYears (age of animal)
#             Non metric variable: Age (Juvenile, Adult, Old)
#----------------------AgeuponOutcome----------------------
#train$UnitofTime = sapply(train$AgeuponOutcome, function(x) strsplit(x, split = ' ') return c(1, "month")
# Get the time value
train$TimeValue = sapply(train$AgeuponOutcome, function(x) strsplit(x, split = ' ')[[1]][1])
# Get unit of time
train$UnitofTime = sapply(train$AgeuponOutcome, function(x) strsplit(x, split = ' ')[[1]][2])
# Convert UnitOfTime in factor and TimeValue in numeric
train$UnitofTime = as.factor(train$UnitofTime)
train$TimeValue = as.numeric(train$TimeValue)
# Convert TimeValue in years using the appropriate divider based on UnitofTime
Divider <- ifelse(train$UnitofTime == 'day' | train$UnitofTime == 'days', 365,
ifelse(train$UnitofTime == 'week' | train$UnitofTime == 'weeks', 52,
ifelse(train$UnitofTime == 'month' | train$UnitofTime == 'months', 12,
ifelse(train$UnitofTime == 'year' | train$UnitofTime == 'years', 1, NA))))
train$AgeinYears = train$TimeValue / Divider
train$AgeinYears = ifelse(train$AgeinYears < 0.5, 0,
ifelse(train$AgeinYears >= 0.5 & train$AgeinYears < 1, 1, train$AgeinYears))
train$Age_alpha = ifelse(train$AgeinYears < 2, "Juvenile",
ifelse(train$AgeinYears >= 2 & train$AgeinYears <= 6, "Adult", "Old"))
train$Age_alpha <- factor(train$Age_alpha, levels = c('Juvenile', 'Adult','Old'))
train$Age = ifelse(train$Age_alpha == "Juvenile", 0,
ifelse(train$Age_alpha == "Adult", 1, 2))
summary(train$Age == 2)
#summary(train$IsIntact == 1)
#------------------------------------------------------------------------------------------------------
# Objective:  Non metric variable: IsMixBreed (0: no, 1: yes)
#             Non metric variable: MixorMultipleorSimple (Mix, Multiple, Simple)
#             Non metric variable: Group (Sporting, NonSporting, Hound, Working,
#                                   Terrier, Toy, Herding, Pitbull)
#             Non metric variable: Size (S, M, L and G)
# Temperament Non metric variable: IsIntelligent (0: no, 1: yes)
#             Non metric variable: IsAggressive (0: no, 1: yes)
#----------------------Breed----------------------
# Website
# http://www.akc.org/dog-breeds/
# http://www.dogbreedslist.info/Tags-L/#.WB9OU-F96T_
# http://dogs.petbreeds.com/
# http://list25.com/25-most-dangerous-dog-breeds/
# https://pethelpful.com/dogs/100-smartest-dog-breeds
# Keep dominant breed
train$SimpleBreed <- sapply(train$Breed, function(x) gsub(' Mix', '', strsplit(x, split = '/')[[1]][1]))
# unique(train$SimpleBreed)
###### Statistics of Breeds
# unique(train$Breed, incomparables = FALSE)
# frequency_table <- table(train$SimpleBreed)
# sort(frequency_table, decreasing = TRUE)
# Mix or Simple breed
train$IsMixBreed <- ifelse(grepl('Mix', train$Breed), 1, 0)
# Mix/Multiple or Simple breed
train$MixorMultipleorSimple <- ifelse(grepl('Mix', train$Breed), "Mix",
ifelse(grepl('/', train$Breed), "Multiple", "Simple"))
# Merge train data with dog_breeds based on SimpleBreed
train <- merge(train, dog_breeds, by = ("SimpleBreed"), all.x = TRUE)
train$Size_alpha <- factor(train$Size_alpha, levels = c('S', 'M','L', 'G'))
train$Size = ifelse(train$Size_alpha == 'S', 0,
ifelse(train$Size_alpha == 'M', 1,
ifelse(train$Size_alpha == 'L', 2, 3)))
# TRACKING
nrow(train)     #15595
#------------------------------------------------------------------------------------------------------
# Objective: Non metric variable: IsMixColor (0: no, 1: yes)
#----------------------Color----------------------
# unique(train$Color, incomparables = FALSE)
train$IsMixColor <- ifelse(grepl("/", train$Color), 1, 0)
################################################################################################################
#----------------------Reordering the columns in data frame----------------------
train <- train[c("OutcomeType", "HasName", "TimeofDay","WeekDay", "Sex", "IsIntact",
"AgeinYears", "Age", "IsMixBreed","MixorMultipleorSimple", "Group", "Size", "IsMixColor")]
#----------------------Check missing values----------------------
sum(is.na(train$HasName))
sum(is.na(train$TimeofDay))
sum(is.na(train$WeekDay))
sum(is.na(train$Sex))
sum(is.na(train$IsIntact))
sum(is.na(train$AgeinYears))
sum(is.na(train$Age))
sum(is.na(train$IsMixBreed))
sum(is.na(train$MixorMultipleorSimple))
sum(is.na(train$Group))
sum(is.na(train$Size))
sum(is.na(train$IsMixColor))
sum(!complete.cases(train))
#----------------------Delete missing values----------------------
train <- na.omit(train)
library(lubridate)  # dates
library(ggplot2)  # visualize
library(ggthemes)
library(dplyr) # data manipulation
library(nnet)   # multinomial regression
library(VGAM)   # multinomial regression
library(randomForest) # classification algorithm
library(xgboost)    # tree learning algorithm
library(formattable)
library(pander)
#library(VIM)
#library(mice)   # missing value
# Read data
train <- read.csv('train.csv', header = T, stringsAsFactors = F, na.strings = "", strip.white=TRUE)
dog_breeds <- read.csv("dog_breeds.csv", header = T, stringsAsFactors = FALSE, strip.white=TRUE)
#unique(train$SexuponOutcome)
###########################################################################
#                          Data preprocessing                             #
###########################################################################
################################################################################################################
# Data of dogs
train = subset(train, train$AnimalType !="Cat")
# TRACKING
nrow(train)   # 15595
#------------------------------------------------------------------------------------------------------
# Objective: Non-metric variable: HasName (0: has name, 1: no name)
#----------------------Name----------------------
# Replace blank names with "Nameless"
#train$Name <- ifelse(is.na(train$Name)==TRUE), 'Nameless', train$Name)
train$Name[is.na(train$Name)] <- "Nameless"
# Make a name/no name variable
#train$HasName[train$Name == 'Nameless'] <- 0
#train$HasName[train$Name != 'Nameless'] <- 1
train$HasName = ifelse(train$Name == 'Nameless', 0, 1)
#------------------------------------------------------------------------------------------------------
# Objective:  Non metric variable: TimeofDay (morning, midday, lateday and night)
#             Non metric variable: WeekDay (Monday, Tuesday, ..., Sunday)
#----------------------DateTime----------------------
# Extract time variables from date (uses the "lubridate" package)
train$Hour    <- hour(train$DateTime)
train$Weekday <- wday(train$DateTime)
train$Month   <- month(train$DateTime)
train$Year    <- year(train$DateTime)
train$TimeofDay <-  ifelse(train$Hour >= 5 & train$Hour < 11, 'morning',
ifelse(train$Hour >= 11 & train$Hour < 16, 'midday',
ifelse(train$Hour >= 15 & train$Hour < 20, 'lateday', 'night')))
train$TimeofDay <- factor(train$TimeofDay, levels = c('morning', 'midday','lateday', 'night'))
# Get the date value
train$Date = sapply(train$DateTime, function(x) strsplit(x, split = ' ')[[1]][1])
train$WeekDay = weekdays(as.Date(train$Date))
train$WeekDay <- factor(train$WeekDay, levels = c("Monday", "Tuesday","Wednesday", "Thursday",
"Friday", "Saturday", "Sunday"))
#------------------------------------------------------------------------------------------------------
# Objective: Non metric dependent variable Outcome (Return_to_owner, Adoption, Transfer, Euthanasia, Died)
#----------------------OutcomeType----------------------
unique(train$OutcomeType, incomparables = FALSE)
subset(train, train$OutcomeType !="Relocate")
train = subset(train, train$OutcomeType !="Relocate")
train = subset(train, train$OutcomeType !="Disposal")
train = subset(train, train$OutcomeType !="Missing")
library(lubridate)  # dates
library(ggplot2)  # visualize
library(ggthemes)
library(dplyr) # data manipulation
library(nnet)   # multinomial regression
library(VGAM)   # multinomial regression
library(randomForest) # classification algorithm
library(xgboost)    # tree learning algorithm
library(formattable)
library(pander)
#library(VIM)
#library(mice)   # missing value
# Read data
train <- read.csv('train.csv', header = T, stringsAsFactors = F, na.strings = "", strip.white=TRUE)
dog_breeds <- read.csv("dog_breeds.csv", header = T, stringsAsFactors = FALSE, strip.white=TRUE)
#unique(train$SexuponOutcome)
###########################################################################
#                          Data preprocessing                             #
###########################################################################
################################################################################################################
# Data of dogs
train = subset(train, train$AnimalType !="Cat")
# TRACKING
nrow(train)   # 15595
#------------------------------------------------------------------------------------------------------
# Objective: Non-metric variable: HasName (0: has name, 1: no name)
#----------------------Name----------------------
# Replace blank names with "Nameless"
#train$Name <- ifelse(is.na(train$Name)==TRUE), 'Nameless', train$Name)
train$Name[is.na(train$Name)] <- "Nameless"
# Make a name/no name variable
#train$HasName[train$Name == 'Nameless'] <- 0
#train$HasName[train$Name != 'Nameless'] <- 1
train$HasName = ifelse(train$Name == 'Nameless', 0, 1)
#------------------------------------------------------------------------------------------------------
# Objective:  Non metric variable: TimeofDay (morning, midday, lateday and night)
#             Non metric variable: WeekDay (Monday, Tuesday, ..., Sunday)
#----------------------DateTime----------------------
# Extract time variables from date (uses the "lubridate" package)
train$Hour    <- hour(train$DateTime)
train$Weekday <- wday(train$DateTime)
train$Month   <- month(train$DateTime)
train$Year    <- year(train$DateTime)
train$TimeofDay <-  ifelse(train$Hour >= 5 & train$Hour < 11, 'morning',
ifelse(train$Hour >= 11 & train$Hour < 16, 'midday',
ifelse(train$Hour >= 15 & train$Hour < 20, 'lateday', 'night')))
train$TimeofDay <- factor(train$TimeofDay, levels = c('morning', 'midday','lateday', 'night'))
# Get the date value
train$Date = sapply(train$DateTime, function(x) strsplit(x, split = ' ')[[1]][1])
train$WeekDay = weekdays(as.Date(train$Date))
train$WeekDay <- factor(train$WeekDay, levels = c("Monday", "Tuesday","Wednesday", "Thursday",
"Friday", "Saturday", "Sunday"))
#------------------------------------------------------------------------------------------------------
# Objective: Non metric dependent variable Outcome (Return_to_owner, Adoption, Transfer, Euthanasia, Died)
#----------------------OutcomeType----------------------
unique(train$OutcomeType, incomparables = FALSE)
train = subset(train, train$OutcomeType !="Relocate")
train = subset(train, train$OutcomeType !="Disposal")
train = subset(train, train$OutcomeType !="Missing")
train$OutcomeType <- factor(train$OutcomeType, levels = c('Adoption', 'Transfer','Return_to_owner',
"Euthanasia", "Died"))
nrow(train)
#------------------------------------------------------------------------------------------------------
# Objective: Delete this unused variable
#----------------------OutcomeSubType----------------------
#unique(train$OutcomeSubtype, incomparables = FALSE)
# This information is not really helpful --> Delete
train$OutcomeSubtype <- NULL
#------------------------------------------------------------------------------------------------------
# Objective:  Non metric variable: IsIntact (0: no, 1: yes)
#             Non metric variable: Sex (Male, Female)
#----------------------SexuponOutcome----------------------
unique(train$SexuponOutcome, incomparables = FALSE)
#train$sex = sapply(train$SexuponOutcome, function(x) strsplit(x, split = ' ')[[1]][1])
train$IsIntact =    ifelse(train$SexuponOutcome == "Neutered Male" | train$SexuponOutcome == "Spayed Female", 0,
ifelse(train$SexuponOutcome == "Intact Male" | train$SexuponOutcome == "Intact Female", 1, NA))
train$Sex =   ifelse(train$SexuponOutcome == "Neutered Male" | train$SexuponOutcome == "Intact Male", 'Male',
ifelse(train$SexuponOutcome == "Spayed Female" | train$SexuponOutcome == "Intact Female", "Female",
NA))
# TRACKING
#nrow(train)   # 15595
#summary(train$Sex == "Male")
#summary(train$IsIntact == 0)
#------------------------------------------------------------------------------------------------------
# Objective:  Metric variable: AgeinYears (age of animal)
#             Non metric variable: Age (Juvenile, Adult, Old)
#----------------------AgeuponOutcome----------------------
#train$UnitofTime = sapply(train$AgeuponOutcome, function(x) strsplit(x, split = ' ') return c(1, "month")
# Get the time value
train$TimeValue = sapply(train$AgeuponOutcome, function(x) strsplit(x, split = ' ')[[1]][1])
# Get unit of time
train$UnitofTime = sapply(train$AgeuponOutcome, function(x) strsplit(x, split = ' ')[[1]][2])
# Convert UnitOfTime in factor and TimeValue in numeric
train$UnitofTime = as.factor(train$UnitofTime)
train$TimeValue = as.numeric(train$TimeValue)
# Convert TimeValue in years using the appropriate divider based on UnitofTime
Divider <- ifelse(train$UnitofTime == 'day' | train$UnitofTime == 'days', 365,
ifelse(train$UnitofTime == 'week' | train$UnitofTime == 'weeks', 52,
ifelse(train$UnitofTime == 'month' | train$UnitofTime == 'months', 12,
ifelse(train$UnitofTime == 'year' | train$UnitofTime == 'years', 1, NA))))
train$AgeinYears = train$TimeValue / Divider
train$AgeinYears = ifelse(train$AgeinYears < 0.5, 0,
ifelse(train$AgeinYears >= 0.5 & train$AgeinYears < 1, 1, train$AgeinYears))
train$Age_alpha = ifelse(train$AgeinYears < 2, "Juvenile",
ifelse(train$AgeinYears >= 2 & train$AgeinYears <= 6, "Adult", "Old"))
train$Age_alpha <- factor(train$Age_alpha, levels = c('Juvenile', 'Adult','Old'))
train$Age = ifelse(train$Age_alpha == "Juvenile", 0,
ifelse(train$Age_alpha == "Adult", 1, 2))
summary(train$Age == 2)
#summary(train$IsIntact == 1)
#------------------------------------------------------------------------------------------------------
# Objective:  Non metric variable: IsMixBreed (0: no, 1: yes)
#             Non metric variable: MixorMultipleorSimple (Mix, Multiple, Simple)
#             Non metric variable: Group (Sporting, NonSporting, Hound, Working,
#                                   Terrier, Toy, Herding, Pitbull)
#             Non metric variable: Size (S, M, L and G)
# Temperament Non metric variable: IsIntelligent (0: no, 1: yes)
#             Non metric variable: IsAggressive (0: no, 1: yes)
#----------------------Breed----------------------
# Website
# http://www.akc.org/dog-breeds/
# http://www.dogbreedslist.info/Tags-L/#.WB9OU-F96T_
# http://dogs.petbreeds.com/
# http://list25.com/25-most-dangerous-dog-breeds/
# https://pethelpful.com/dogs/100-smartest-dog-breeds
# Keep dominant breed
train$SimpleBreed <- sapply(train$Breed, function(x) gsub(' Mix', '', strsplit(x, split = '/')[[1]][1]))
# unique(train$SimpleBreed)
###### Statistics of Breeds
# unique(train$Breed, incomparables = FALSE)
# frequency_table <- table(train$SimpleBreed)
# sort(frequency_table, decreasing = TRUE)
# Mix or Simple breed
train$IsMixBreed <- ifelse(grepl('Mix', train$Breed), 1, 0)
# Mix/Multiple or Simple breed
train$MixorMultipleorSimple <- ifelse(grepl('Mix', train$Breed), "Mix",
ifelse(grepl('/', train$Breed), "Multiple", "Simple"))
# Merge train data with dog_breeds based on SimpleBreed
train <- merge(train, dog_breeds, by = ("SimpleBreed"), all.x = TRUE)
train$Size_alpha <- factor(train$Size_alpha, levels = c('S', 'M','L', 'G'))
train$Size = ifelse(train$Size_alpha == 'S', 0,
ifelse(train$Size_alpha == 'M', 1,
ifelse(train$Size_alpha == 'L', 2, 3)))
# TRACKING
nrow(train)     #15595
#------------------------------------------------------------------------------------------------------
# Objective: Non metric variable: IsMixColor (0: no, 1: yes)
#----------------------Color----------------------
# unique(train$Color, incomparables = FALSE)
train$IsMixColor <- ifelse(grepl("/", train$Color), 1, 0)
################################################################################################################
#----------------------Reordering the columns in data frame----------------------
train <- train[c("OutcomeType", "HasName", "TimeofDay","WeekDay", "Sex", "IsIntact",
"AgeinYears", "Age", "IsMixBreed","MixorMultipleorSimple", "Group", "Size", "IsMixColor")]
#----------------------Check missing values----------------------
sum(is.na(train$HasName))
sum(is.na(train$TimeofDay))
sum(is.na(train$TimeofDay))
sum(is.na(train$WeekDay))
