distribution_system <- factor(hbat[,6])		#categorial variable
e_commerce <- hbat[,8]
technical_support <- hbat[,9]
new_products <- hbat[,16]
price_flexibility <- hbat[,18]
deliver_speed <- hbat[,19]
#--------------Problem 3--------------
#Problem a
model1 = glm(future_relationship~customer_type+distribution_system
+e_commerce+new_products, family = binomial(), data = hbat)
summary(model1)
model2 = glm(future_relationship~customer_type+distribution_system
+e_commerce, family = binomial(), data = hbat)
summary(model2)
exp(cbind(OR = coef(model1), confint(model1)))
plot(model1)
#Problem d
require(rms)
install.packages("rms")
lrm(model1)
library("rms", lib.loc="/Library/Frameworks/R.framework/Versions/3.3/Resources/library")
lrm(model1)
model2 <- glm(future_relationship ~ 1, family="binomial")
1-logLik(model1)/logLik(model2)
#Problem e
posthoc1 <- aov(future_relationship~future_relationship~customer_type+distribution_system
+e_commerce+new_products)
HSD.test(posthoc1, "customer_type",group = T, console = T)
+e_commerce+new_products)
posthoc1 <- aov(future_relationship~customer_type+distribution_system
+e_commerce+new_products)
HSD.test(posthoc1, "customer_type",group = T, console = T)
library(agricolae)
posthoc1 <- aov(future_relationship~customer_type+distribution_system
+e_commerce+new_products)
HSD.test(posthoc1, "customer_type",group = T, console = T)
model2 <- glm(future_relationship ~ 1, family="binomial")
1-logLik(model1)/logLik(model2)
product_quality <- hbat[,7]
model3 <- glm(future_relationship~customer_type+distribution_system+product_quality
+e_commerce+new_products, family = binomial(), data = hbat)
summary(model3)
1-logLik(model1)/logLik(model3)
library(nnet)
model4 = multinom(customer_type~firm_size+distribution_system+technical_support
+price_flexibility+deliver_speed, data = hbat)
summary(model4)
#Problem c
model5 = multinom(customer_type~1)
1-logLik(model4)/logLik(model5)
#Read file
hbat <-read.csv("hbat_200.csv",header = T)
#Variables
future_relationship <- hbat[,24]			    #consider strategic alliance/partnership in future
customer_type <- factor(hbat[,2])         #categorial variable
firm_size <- factor(hbat[,4])	            #categorial variable
distribution_system <- factor(hbat[,6])		#categorial variable
product_quality <- hbat[,7]
e_commerce <- hbat[,8]
technical_support <- hbat[,9]
new_products <- hbat[,16]
price_flexibility <- hbat[,18]
deliver_speed <- hbat[,19]
#--------------Problem 3--------------
#Problem a
model1 = glm(future_relationship~customer_type+distribution_system
+e_commerce+new_products, family = binomial(), data = hbat)
summary(model1)
exp(cbind(OR = coef(model1), confint(model1)))
#Problem c
library(agricolae)
posthoc1 <- aov(future_relationship~customer_type+distribution_system
+e_commerce+new_products)
HSD.test(posthoc1, "customer_type",group = T, console = T)
#Problem d
model2 <- glm(future_relationship ~ 1, family="binomial")
1-logLik(model1)/logLik(model2)
#Problem e
plot(model1)
#--------------Problem 4--------------
#Problem a
library(nnet)
model4 = multinom(customer_type~firm_size+distribution_system+technical_support
+price_flexibility+deliver_speed, data = hbat)
summary(model4)
#Problem c
model5 = multinom(customer_type~1)
1-logLik(model4)/logLik(model5)
#Read file
hbat <-read.csv("hbat_200.csv",header = T)
#Variables
future_relationship <- hbat[,24]			    #consider strategic alliance/partnership in future
customer_type <- factor(hbat[,2])         #categorial variable
firm_size <- factor(hbat[,4])	            #categorial variable
distribution_system <- factor(hbat[,6])		#categorial variable
product_quality <- hbat[,7]
e_commerce <- hbat[,8]
technical_support <- hbat[,9]
new_products <- hbat[,16]
price_flexibility <- hbat[,18]
deliver_speed <- hbat[,19]
#--------------Problem 3--------------
#Problem a
model1 = glm(future_relationship~customer_type+distribution_system
+e_commerce+new_products, family = binomial(), data = hbat)
summary(model1)
exp(cbind(OR = coef(model1), confint(model1)))
#Problem c
library(agricolae)
posthoc1 <- aov(future_relationship~customer_type+distribution_system
+e_commerce+new_products)
HSD.test(posthoc1, "customer_type",group = T, console = T)
#Problem d
model2 <- glm(future_relationship ~ 1, family="binomial")
1-logLik(model1)/logLik(model2)
#Problem e
plot(model1)
model3 <- glm(future_relationship~customer_type+distribution_system+product_quality
+e_commerce+new_products, family = binomial(), data = hbat)
summary(model3)
library(nnet)
model4 = multinom(customer_type~firm_size+distribution_system+technical_support
+price_flexibility+deliver_speed, data = hbat)
summary(model4)
exp(cbind(OR = coef(model1=4), confint(model4)))
exp(cbind(OR = coef(model4), confint(model4)))
library(nnet)
model4 = multinom(customer_type~firm_size+distribution_system+technical_support
+price_flexibility+deliver_speed, data = hbat)
summary(model4)
install.packages("gmnet")
install.packages("glmnet")
library("glmnet", lib.loc="/Library/Frameworks/R.framework/Versions/3.3/Resources/library")
hbat <-read.csv("hbat_200.csv",header = T)
#Variables
future_relationship <- hbat[,24]			    #consider strategic alliance/partnership in future
customer_type <- factor(hbat[,2])         #categorial variable
firm_size <- factor(hbat[,4])	            #categorial variable
distribution_system <- factor(hbat[,6])		#categorial variable
product_quality <- hbat[,7]
e_commerce <- hbat[,8]
technical_support <- hbat[,9]
new_products <- hbat[,16]
price_flexibility <- hbat[,18]
deliver_speed <- hbat[,19]
#--------------Problem 3--------------
#Problem a
model1 = glm(future_relationship~customer_type+distribution_system
+e_commerce+new_products, family = binomial(), data = hbat)
summary(model1)
exp(cbind(OR = coef(model1), confint(model1)))
#Problem c
library(agricolae)
posthoc1 <- aov(future_relationship~customer_type+distribution_system
+e_commerce+new_products)
HSD.test(posthoc1, "customer_type",group = T, console = T)
#Problem d
model2 <- glm(future_relationship ~ 1, family="binomial")
1-logLik(model1)/logLik(model2)
#Problem e
plot(model1)
#--------------Problem 4--------------
#Problem a
library(nnet)
model4 <- multinom(customer_type~firm_size+distribution_system+technical_support
+price_flexibility+deliver_speed, data = hbat)
summary(model4)
#install.packages("glmnet")
model4 <- glmnet(customer_type~firm_size+distribution_system+technical_support
+price_flexibility+deliver_speed, data = hbat)
model4 <- glmnet(customer_type~firm_size+distribution_system+technical_support
+price_flexibility+deliver_speed)
model4 <- glmnet(customer_type~firm_size+distribution_system+technical_support
+price_flexibility+deliver_speed, family = multinom())
summary(model4)
model4 <- glmnet(customer_type~firm_size+distribution_system+technical_support
+price_flexibility+deliver_speed, family = multinom())
model5 <- glmnet(customer_type~firm_size+distribution_system+technical_support
+price_flexibility+deliver_speed, family = multinom())
summary(model5)
#Problem c
model4 <- multinom(customer_type~firm_size+distribution_system+technical_support
+price_flexibility+deliver_speed, data = hbat)
summary(model4)
model5 <- glmnet(customer_type~firm_size+distribution_system+technical_support
+price_flexibility+deliver_speed, family = "multinomial", lambda=0, type.multinomial="grouped")
x <- cbind(firm_size,distribution_system,technical_support,price_flexibility,deliver_speed)
model5 <- glmnet(x, customer_type,family="multinomial", lambda=0, type.multinomial="grouped"))
model5 <- glmnet(x, customer_type,family="multinomial", lambda=0, type.multinomial="grouped")
summary(model5)
library(nnet)
model4 <- multinom(customer_type~firm_size+distribution_system+technical_support
+price_flexibility+deliver_speed, data = hbat)
summary(model4)
detach("package:glmnet", unload=TRUE)
z <- summary(model4)$coefficients/summary(model4)$standard.errors #calculate z score
p <- (1 - pnorm(abs(z), 0, 1))*2    #calculate p value
exp(coef(model4))
p
exp(coef(model4))
library(nnet)
model4 <- multinom(customer_type~firm_size+distribution_system+technical_support
+price_flexibility+deliver_speed, data = hbat)
summary(model4)
install.packages("VGAM")
+price_flexibility+deliver_speed, family=multinomial(refLevel=1), data=hbat)
model5 <- vglm(customer_type~firm_size+distribution_system+technical_support
+price_flexibility+deliver_speed, family=multinomial(refLevel=1), data=hbat)
library("VGAM", lib.loc="/Library/Frameworks/R.framework/Versions/3.3/Resources/library")
model5 <- vglm(customer_type~firm_size+distribution_system+technical_support
+price_flexibility+deliver_speed, family=multinomial(refLevel=1), data=hbat)
summary(model5)
model4 <- vglm(customer_type~firm_size+distribution_system+technical_support
z <- summary(test)$coefficients/summary(test)$standard.errors
#install.packages("VGAM")
model4 <- vglm(customer_type~firm_size+distribution_system+technical_support
+price_flexibility+deliver_speed, family=multinomial(refLevel=1), data=hbat)
summary(model4)
library(VGAM)
#Problem c
model5 <- vglm(customer_type ~ 1, family=multinomial(refLevel=1), data=hbat)
LLf <- VGAM::logLik(model4)
LL0 <- VGAM::logLik(model5)
as.vector(1 - (LLf / LL0))  # McFadden pseudo R squared
sumMN   <- VGAM::summary(model4)
#Problem c
sumMN
#install.packages("VGAM")
library(VGAM)
model4 <- vglm(customer_type~firm_size+distribution_system+technical_support
+price_flexibility+deliver_speed, family=multinomial(refLevel=1), data=hbat)
summary(model4)
#Problem c
model5 <- vglm(customer_type ~ 1, family=multinomial(refLevel=1), data=hbat)
LLf <- VGAM::logLik(model4)
LL0 <- VGAM::logLik(model5)
as.vector(1 - (LLf / LL0))  # McFadden pseudo R squared
#Read file
hbat <-read.csv("hbat_200.csv",header = T)
#Variables
future_relationship <- hbat[,24]			    #consider strategic alliance/partnership in future
customer_type <- factor(hbat[,2])         #categorial variable
firm_size <- factor(hbat[,4])	            #categorial variable
distribution_system <- factor(hbat[,6])		#categorial variable
product_quality <- hbat[,7]
e_commerce <- hbat[,8]
technical_support <- hbat[,9]
new_products <- hbat[,16]
price_flexibility <- hbat[,18]
deliver_speed <- hbat[,19]
library(nnet)
model4 <- multinom(customer_type~firm_size+distribution_system+technical_support
+price_flexibility+deliver_speed, data = hbat)
summary(model4)
z <- summary(model4)$coefficients/summary(model4)$standard.errors #calculate z score
p <- (1 - pnorm(abs(z), 0, 1))*2    #calculate p value
p
library(VGAM)
model4 <- vglm(customer_type~firm_size+distribution_system+technical_support
+price_flexibility+deliver_speed, family=multinomial, data=hbat)
summary(model4)
model4 <- vglm(customer_type~firm_size+distribution_system+technical_support
+price_flexibility+deliver_speed, family=multinomial(refLevel = 2), data=hbat)
summary(model4)
model4 <- vglm(customer_type~firm_size+distribution_system+technical_support
+price_flexibility+deliver_speed, family=multinomial(refLevel = 3), data=hbat)
summary(model4)
library(VGAM)
model4 <- vglm(customer_type~firm_size+distribution_system+technical_support
+price_flexibility+deliver_speed, family=multinomial(refLevel = 1), data=hbat)
summary(model4)
z <- summary(model4)$coefficients/summary(model4)$standard.errors #calculate z score
model4 <- multinom(customer_type~firm_size+distribution_system+technical_support
+price_flexibility+deliver_speed, data = hbat)
summary(model4)
z <- summary(model4)$coefficients/summary(model4)$standard.errors #calculate z score
p <- (1 - pnorm(abs(z), 0, 1))*2    #calculate p value
z
install.packages("mlogit")
library("mlogit", lib.loc="/Library/Frameworks/R.framework/Versions/3.3/Resources/library")
library(mlogit)
mlogit(formula = customer_type ~ 0 | firm_size+distribution_system+technical_support
+price_flexibility+deliver_speed, data = hbat, method = "nr", print.level = 0)
mlogit(formula = customer_type ~ 0 | firm_size+distribution_system+technical_support
+price_flexibility+deliver_speed, data = hbat)
mlogit(formula = customer_type ~ 0|firm_size+distribution_system+technical_support
+price_flexibility+deliver_speed, data = hbat)
model6 <- mlogit(formula = customer_type ~ 0|firm_size+distribution_system+technical_support
+price_flexibility+deliver_speed, data = hbat)
model6 <- mlogit(formula = customer_type ~ 0 | firm_size+distribution_system+technical_support
+price_flexibility+deliver_speed, data = hbat)
hbat <- mlogit.data(hbat, choice= customer_type, shape="wide", varying=NULL)
hbat <- mlogit.data(hbat, choice= "customer_type", shape="wide", varying=NULL)
model6 <- mlogit(customer_type ~ 0 | firm_size+distribution_system+technical_support
+price_flexibility+deliver_speed, data = hbat)
hbat <-read.csv("hbat_200.csv",header = T)
H <- mlogit.data(hbat, shape="wide", choice="customer_type", varying=c(3:12))
H <- mlogit.data(hbat, shape="wide", choice="customer_type", varying=NULL)
head(H)
hbat <-read.csv("hbat_200.csv",header = T)
model6 <- mlogit(formula = customer_type ~ 0 | firm_size+distribution_system+technical_support
+price_flexibility+deliver_speed, reflevel=1, data=hbat)
model6 <- mlogit(formula = customer_type ~ 0 | firm_size+distribution_system+technical_support
+price_flexibility+deliver_speed, reflevel="--", data=hbat)
library(mlogit)
H <- mlogit.data(hbat, shape="wide", choice="customer_type")
library(mlogit)
H <- mlogit.data(hbat, shape="wide", choice="X1")
H <- mlogit.data(hbat, shape="wide", choice="X1",varying = NULL)
model6 <- mlogit(formula = customer_type ~ 0 | firm_size+distribution_system+technical_support
+price_flexibility+deliver_speed, reflevel=1, data=hbat)
model6 <- mlogit(formula = customer_type ~ 0 | firm_size+distribution_system+technical_support
+price_flexibility+deliver_speed, reflevel="--", data=hbat)
+price_flexibility+deliver_speed, reflevel="1", data=hbat)
model6 <- mlogit(formula = customer_type ~ 0 | firm_size+distribution_system+technical_support
+price_flexibility+deliver_speed, reflevel="1", data=hbat)
model6 <- mlogit(formula = customer_type ~ 0 | firm_size+distribution_system+technical_support
+price_flexibility+deliver_speed, data=hbat)
H <- mlogit.data(hbat, shape="wide", choice="X1",varying = NULL)
model6 <- mlogit(formula = customer_type ~ 0 | firm_size+distribution_system+technical_support
+price_flexibility+deliver_speed, reflevel="1", data=H)
model6 <- mlogit(formula = customer_type ~ 0 | firm_size+distribution_system+technical_support
+price_flexibility+deliver_speed, reflevel=1, data=H)
summary(model6)
model6 <- mlogit(formula = customer_type ~ 0 | firm_size+distribution_system+technical_support
+price_flexibility+deliver_speed, reflevel="--", data=H)
summary(model6)
model6 <- mlogit(formula = customer_type ~ 0 | firm_size+distribution_system+technical_support
+price_flexibility+deliver_speed, data=H)
summary(model6)
hbat <-read.csv("hbat_200.csv",header = T)
H <- mlogit.data(hbat, shape="wide", choice="X1",varying = NULL)
head(H)
model6 <- mlogit(formula = customer_type ~ 0 | firm_size+distribution_system+technical_support
+price_flexibility+deliver_speed, reflevel=1, data=H)
head(X1)
attach(H)
head(X1)
model6 <- mlogit(formula = customer_type ~ 0 | firm_size+distribution_system+technical_support
+price_flexibility+deliver_speed, reflevel=0, data=H)
summary(model6)
+price_flexibility+deliver_speed, refLevel=0, data=H)
model6 <- mlogit(formula = customer_type ~ 0 | firm_size+distribution_system+technical_support
+price_flexibility+deliver_speed, refLevel=0, data=H)
H <- mlogit.data(hbat, shape="wide", choice="X1")
model6 <- mlogit(formula = customer_type ~ 0 | firm_size+distribution_system+technical_support
+price_flexibility+deliver_speed, refLevel=1, data=H)
hbat <-read.csv("hbat_200.csv",header = T)
H <- mlogit.data(hbat, shape="wide", choice="X1")
model6 <- mlogit(formula = customer_type ~ 0 | firm_size+distribution_system+technical_support
+price_flexibility+deliver_speed, refLevel=1, data=H)
hbat <-read.csv("hbat_200.csv",header = T)
H <- mlogit.data(hbat, shape="wide", choice="X1",varying = NULL)
model6 <- mlogit(formula = customer_type ~ 0 | firm_size+distribution_system+technical_support
+price_flexibility+deliver_speed, refLevel=0, data=H)
head(H)
H <- mlogit.data(hbat, shape="wide", choice="X1",varying = NULL)
model6 <- mlogit(formula = X1 ~ 0 | X3+X5+X8+X17+X18, refLevel=0, data=H)
summary(model6)
#Read file
hbat <-read.csv("hbat_200.csv",header = T)
#Variables
future_relationship <- hbat[,24]			    #consider strategic alliance/partnership in future
customer_type <- factor(hbat[,2])         #categorial variable
firm_size <- factor(hbat[,4])	            #categorial variable
distribution_system <- factor(hbat[,6])		#categorial variable
product_quality <- hbat[,7]
e_commerce <- hbat[,8]
technical_support <- hbat[,9]
new_products <- hbat[,16]
price_flexibility <- hbat[,18]
deliver_speed <- hbat[,19]
library(mlogit)
H <- mlogit.data(hbat, shape="wide", choice="X1",varying = NULL)
customer_type <- factor(H[,2])         #categorial variable
firm_size <- factor(H[,4])	            #categorial variable
distribution_system <- factor(H[,6])		#categorial variable
technical_support <- H[,9]
price_flexibility <- H[,18]
deliver_speed <- H[,19]
model6 <- mlogit(formula = customer_type ~ 0 | firm_size+distribution_system+technical_support
+price_flexibility+deliver_speed, refLevel=0, data=H)
summary(model6)
#Read file
hbat <-read.csv("hbat_200.csv",header = T)
#Variables
future_relationship <- hbat[,24]			    #consider strategic alliance/partnership in future
customer_type <- factor(hbat[,2])         #categorial variable
firm_size <- factor(hbat[,4])	            #categorial variable
distribution_system <- factor(hbat[,6])		#categorial variable
product_quality <- hbat[,7]
e_commerce <- hbat[,8]
technical_support <- hbat[,9]
new_products <- hbat[,16]
price_flexibility <- hbat[,18]
deliver_speed <- hbat[,19]
model5 <- vglm(customer_type~firm_size+distribution_system+technical_support
+price_flexibility+deliver_speed, family=multinomial(refLevel = 1), data=hbat)
summary(model5)
#install.packages("mlogit")
library(mlogit)
H <- mlogit.data(hbat, shape="wide", choice="X1",varying = NULL)
model6 <- mlogit(formula = X1 ~ 0 | X3+X5+X8+X17+X18, refLevel=0, data=H)
summary(model6)
model4 <- multinom(customer_type~firm_size+distribution_system+technical_support
+price_flexibility+deliver_speed, data = hbat)
library(nnet)
model4 <- multinom(customer_type~firm_size+distribution_system+technical_support
+price_flexibility+deliver_speed, data = hbat)
summary(model4)
z <- summary(model4)$coefficients/summary(model4)$standard.errors #calculate z score
z
p <- (1 - pnorm(abs(z), 0, 1))*2    #calculate p value
p
library(VGAM)
model5 <- vglm(customer_type~firm_size+distribution_system+technical_support
+price_flexibility+deliver_speed, family=multinomial(refLevel = 1), data=hbat)
summary(model5)
lrtest(model6)
lrtest(model5)
lrtest(model5)
setwd("~/Documents/Github/predicting-dog-outcomes/py_process/input")
train <-read.csv("train.csv",header = T)
View(train)
OutcomeType <- factor(data$OutcomeType)			    #consider strategic alliance/partnership in future
OutcomeType <- data$OutcomeType			    #consider strategic alliance/partnership in future
OutcomeType <- factor(train[,2])			    #consider strategic alliance/partnership in future
HasName <- factor[,5]
HasName <- factor(train[,5])
#Read file
train <-read.csv("train.csv",header = T)
#Variables
OutcomeType <- factor(train[,2])
Age <- train[,3]
Size <- train[,4]
HasName <- factor(train[,5])
TimeofDay <- factor(train[,6])
WeekDay <- factor(train[,7])
IsIntact <- factor(train[,8])
Sex <- factor(train[,9])
PureMixedHybrid <- factor(train[,10])
Group <- factor(train[,11])
IsMixeColor <- factor(train[,12])
WeekDay <- factor(train[,7], level='6')
WeekDay <- factor(train[,7], ref='6')
WeekDay <- factor(train[,7])
WeekDay <- relevel(WeekDay, ref="6")
WeekDay <- relevel(WeekDay, ref="6")
IsIntact <- factor(train[,8])
train <-read.csv("train.csv",header = T)
#Variables
OutcomeType <- factor(train[,2])
Age <- train[,3]
Size <- train[,4]
HasName <- factor(train[,5])
TimeofDay <- factor(train[,6])
TimeofDay <- relevel(TimeofDay, ref="lateday")
WeekDay <- factor(train[,7])
WeekDay <- relevel(WeekDay, ref="6")
IsIntact <- factor(train[,8])
Sex <- factor(train[,9])
PureMixedHybrid <- factor(train[,10])
PureMixedHybrid <- relevel(PureMixedHybrid, ref="Mixed")
Group <- factor(train[,11])
Group <- relevel(Group, ref="Toy")
IsMixeColor <- factor(train[,12])
#--------------Problem 4--------------
#Problem a
#install.packages("nnet")
library(VGAM)
model5 <- vglm(OutcomeType~Age+Size+HasName+TimeofDay+WeekDay+IsIntact
+Sex+PureMixedHybrid+Group+IsMixeColor, family=multinomial(refLevel = 'Adoption'), data=train)
summary(model5)
library(VGAM)
library(nnet)
model1 <- multinom(OutcomeType~Age+Size+HasName+TimeofDay+WeekDay+IsIntact
+Sex+PureMixedHybrid+Group+IsMixeColor, data = train)
summary(model4)
model1 <- multinom(OutcomeType~Age+Size+HasName+TimeofDay+WeekDay+IsIntact
+Sex+PureMixedHybrid+Group+IsMixeColor, data = train)
summary(model4)
summary(model1)
#Read file
train <-read.csv("train.csv",header = T)
#Variables
OutcomeType <- factor(train[,2])
Age <- train[,3]
Size <- train[,4]
HasName <- factor(train[,5])
TimeofDay <- factor(train[,6])
TimeofDay <- relevel(TimeofDay, ref="lateday")
WeekDay <- factor(train[,7])
WeekDay <- relevel(WeekDay, ref="Sunday")
IsIntact <- factor(train[,8])
Sex <- factor(train[,9])
PureMixedHybrid <- factor(train[,10])
PureMixedHybrid <- relevel(PureMixedHybrid, ref="Mixed")
Group <- factor(train[,11])
Group <- relevel(Group, ref="Toy")
IsMixeColor <- factor(train[,12])
#--------------Problem 4--------------
#Problem a
#install.packages("nnet")
library(nnet)
model1 <- multinom(OutcomeType~Age+Size+HasName+TimeofDay+WeekDay+IsIntact
+Sex+PureMixedHybrid+Group+IsMixeColor, data = train)
summary(model1)
WeekDay <- relevel(WeekDay, ref="Sunday")
library(nnet)
model1 <- multinom(OutcomeType~Age+Size+HasName+TimeofDay+WeekDay+IsIntact
+Sex+PureMixedHybrid+Group+IsMixeColor, data = train)
summary(model1)
